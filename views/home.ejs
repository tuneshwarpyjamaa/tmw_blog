<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>The Mandate Wire - Unpacking the Power, Analyzing the Policy</title>
   <!-- Load Tailwind CSS -->
   <script src="https://cdn.tailwindcss.com"></script>
   <!-- Configure Tailwind and custom styles -->
   <style>
       /* Use Inter font - specifying weights for cleaner typography */
       @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap');

       :root {
           --accent-color: #1d4ed8; /* Blue-700 - Professional blue */
           --dark-bg: #111827; /* Dark Slate Gray - Professional */
           --light-bg: #f9fafb;
           --section-title: #374151; /* Darker gray for section headers */
       }

       body {
           font-family: 'Inter', sans-serif;
           background-color: #ffffff; /* White background for maximum clarity/readability */
           color: #1f2937;
       }

       .dark-section {
           background-color: var(--dark-bg);
           color: #f3f4f6;
       }

       .section-header {
           font-size: 1.5rem; /* text-2xl */
           font-weight: 800; /* font-extrabold */
           color: var(--section-title);
           border-bottom: 3px solid var(--accent-color); /* Strong accent line */
           padding-bottom: 0.5rem;
           margin-bottom: 1.5rem;
       }

       /* Card styles for content density */
       .story-card {
           display: flex;
           flex-direction: column;
           border-bottom: 1px solid #e5e7eb;
           padding-bottom: 1rem;
           margin-bottom: 1rem;
           transition: background-color 0.2s;
       }
       .story-card:hover {
           background-color: #f9fafb;
       }

       /* Top story specific styling */
       .top-story-card {
           background-color: #ffffff;
           transition: all 0.3s;
       }
       .top-story-card:hover {
           box-shadow: 0 4px 6px -1px rgba(29, 78, 216, 0.1), 0 2px 4px -2px rgba(29, 78, 216, 0.05);
       }
   </style>
</head>
<body>

   <!-- Main Navigation Bar (Dark Slate) -->
   <header class="dark-section shadow-xl sticky top-0 z-10 border-b border-gray-700">
       <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
           <div class="flex justify-between items-center h-16"> <!-- Reduced height for news feel -->
               <!-- Logo -->
               <a href="/" class="text-3xl font-extrabold tracking-tight text-white p-1">
                   <span class="text-blue-500">The</span> Mandate Wire
               </a>

               <!-- Desktop Nav Links -->
               <nav class="hidden md:flex space-x-6">
                   <a href="/posts" class="text-gray-300 hover:text-blue-400 font-semibold transition duration-200">Home</a>
                   <a href="/posts" class="text-gray-300 hover:text-blue-400 font-semibold transition duration-200">News</a>
                   <a href="/posts" class="text-gray-300 hover:text-blue-400 font-semibold transition duration-200">Sport</a>
                   <a href="/posts" class="text-gray-300 hover:text-blue-400 font-semibold transition duration-200">Business</a>
                   <a href="/posts" class="text-gray-300 hover:text-blue-400 font-semibold transition duration-200">Innovation</a>
                   <a href="/posts" class="text-gray-300 hover:text-blue-400 font-semibold transition duration-200">Culture</a>
                   <a href="/posts" class="text-gray-300 hover:text-blue-400 font-semibold transition duration-200">Arts</a>
                   <a href="/posts" class="text-gray-300 hover:text-blue-400 font-semibold transition duration-200">Travel</a>
                   <a href="/posts" class="text-gray-300 hover:text-blue-400 font-semibold transition duration-200">Earth</a>
               </nav>

               <!-- Login/Contribute Button (For writers/members) -->
               <% if (userId) { %>
                   <div class="flex items-center space-x-4">
                       <a href="/posts/create" class="hidden md:inline-flex items-center justify-center px-4 py-2 text-xs font-bold rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition duration-300">
                           Create Post
                       </a>
                       <form action="/auth/logout" method="post" style="display:inline;">
                           <button type="submit" class="hidden md:inline-flex items-center justify-center px-4 py-2 text-xs font-bold rounded-md shadow-sm text-white bg-gray-600 hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition duration-300">
                               Logout
                           </button>
                       </form>
                   </div>
               <% } else { %>
                   <a href="/auth/login" class="hidden md:inline-flex items-center justify-center px-4 py-2 text-xs font-bold rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition duration-300">
                       Contribute / Login
                   </a>
               <% } %>
           </div>
       </div>
   </header>

   <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
       
       <!-- Masthead and Quick Links -->
       <section class="py-4 border-b-2 border-gray-300">
           <div class="md:flex justify-between items-center text-center md:text-left">
               <h1 class="text-xl font-bold text-gray-900"><%= new Date().toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric', year: 'numeric' }) %></h1>
               <nav class="flex justify-center md:justify-end space-x-4 mt-2 md:mt-0 text-sm font-medium">
                   <a href="/posts" class="text-blue-700 hover:text-blue-500 transition duration-200">Live Updates</a>
                   <span class="text-gray-400">|</span>
                   <a href="/posts" class="text-gray-600 hover:text-blue-500 transition duration-200">Podcast</a>
                   <span class="text-gray-400">|</span>
                   <a href="/posts" class="text-gray-600 hover:text-blue-500 transition duration-200">Editorial Board</a>
               </nav>
           </div>
       </section>

       <!-- MAIN NEWS GRID: High Density, 3-Column Layout on Desktop -->
       <section id="news-grid" class="py-8 md:py-12">

           <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">

               <!-- COLUMN 1: TOP STORY FEATURE (Large Card) -->
               <div class="lg:col-span-2">
                   <h2 class="section-header">Top Story</h2>

                   <% if (posts.length > 0) { %>
                       <a href="/posts/<%= posts[0].post_id %>" class="block top-story-card cursor-pointer rounded-lg">
                           <div class="mb-4 aspect-video bg-gray-100 overflow-hidden">
                               <img src="https://placehold.co/1200x675/000000/ffffff?text=FEATURED+STORY+VISUAL"
                                    alt="Featured Story Visual"
                                    class="w-full h-full object-cover">
                           </div>
                           <p class="text-sm font-semibold uppercase tracking-wider text-red-700 mb-2"><%= posts[0].category || 'Uncategorized' %></p>
                           <h3 class="text-3xl md:text-4xl font-extrabold text-gray-900 mb-2 leading-tight hover:text-blue-700 transition duration-200">
                               <%= posts[0].title %>
                           </h3>
                           <p class="text-lg text-gray-600">
                               <%= posts[0].content.substring(0, 300) %>...
                           </p>
                           <p class="text-xs text-gray-500 mt-3">By: <%= posts[0].username %> | <%= new Date(posts[0].published_at || posts[0].created_at).toLocaleDateString() %></p>
                       </a>
                   <% } %>
               </div>

               <!-- COLUMN 2: SECONDARY STORIES (List Format) -->
               <div class="lg:col-span-1 border-r border-gray-200 pr-8">
                   <h2 class="section-header">Markets & Trade</h2>

                   <div class="space-y-4">
                       <% posts.slice(1, 4).forEach((post, index) => { %>
                           <!-- Story -->
                           <a href="/posts/<%= post.post_id %>" class="story-card">
                               <p class="text-xs font-semibold uppercase text-blue-700 mb-1"><%= post.category || 'Uncategorized' %></p>
                               <h4 class="text-lg font-bold text-gray-900 hover:text-blue-700 leading-snug">
                                   <%= post.title %>
                               </h4>
                               <p class="text-sm text-gray-500 mt-1"><%= post.content.substring(0, 100) %>...</p>
                               <p class="text-xs text-gray-500 mt-2"><%= new Date(post.published_at || post.created_at).toLocaleDateString() %></p>
                           </a>
                       <% }); %>
                   </div>
               </div>

               <!-- COLUMN 3: OPINION & COMMENTARY (Module) -->
               <div class="lg:col-span-1">
                   <h2 class="section-header">Opinion</h2>

                   <div class="space-y-4">
                       <% posts.slice(4, 7).forEach((post, index) => { %>
                           <!-- Opinion -->
                           <a href="/posts/<%= post.post_id %>" class="story-card">
                               <p class="text-xs font-semibold uppercase text-blue-700"><%= post.category || 'Uncategorized' %></p>
                               <h4 class="text-lg font-bold text-gray-900 hover:text-blue-700 leading-snug">
                                   <%= post.title %>
                               </h4>
                           </a>
                       <% }); %>

                       <!-- Module: Newsletter CTA (Integrated) -->
                       <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                            <h4 class="text-xl font-bold text-gray-900 mb-2">Daily Policy Brief</h4>
                            <p class="text-sm text-gray-600 mb-3">Get the day's essential analysis delivered to your inbox.</p>
                            <input type="email" placeholder="Your Email" class="w-full p-2 text-sm border border-gray-300 rounded-md mb-2">
                            <button onclick="handleSubscribe()" class="w-full py-2 text-sm font-semibold text-white bg-blue-700 rounded-md hover:bg-blue-800">
                               Subscribe
                            </button>
                            <p id="subscription-message" class="mt-2 text-xs text-gray-500 h-4"></p>
                       </div>
                   </div>
               </div>
           </div>
       </section>
       
       <!-- Horizontal Divider -->
       <hr class="border-t-2 border-gray-300 my-8">

       <!-- SECONDARY SECTION: Geopolitics (Modular Grid) -->
       <section id="geopolitics" class="pb-12">
           <h2 class="section-header">Geopolitical Risk</h2>

           <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
               <% posts.slice(7, 10).forEach((post, index) => { %>
                   <!-- Story -->
                   <a href="/posts/<%= post.post_id %>" class="story-card p-4 rounded-lg bg-white border border-gray-100 shadow-sm">
                       <div class="mb-3 h-40 bg-gray-100 overflow-hidden rounded-md">
                           <img src="https://placehold.co/600x400/f3f4f6/4b5563?text=<%= encodeURIComponent(post.title.substring(0, 20)) %>"
                                alt="<%= post.title %>"
                                class="w-full h-full object-cover">
                       </div>
                       <p class="text-xs font-semibold uppercase tracking-wider text-green-700 mb-1"><%= post.category || 'Uncategorized' %></p>
                       <h3 class="text-xl font-bold text-gray-900 hover:text-blue-700 leading-snug">
                           <%= post.title %>
                       </h3>
                       <p class="text-sm text-gray-600 mt-2"><%= post.content.substring(0, 150) %>...</p>
                   </a>
               <% }); %>
           </div>
       </section>

   <!-- Footer (Dark Slate) - Consistent with other pages -->
   <footer class="dark-section border-t border-gray-700/50 py-12">
       <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center md:text-left">
           <div class="grid grid-cols-2 md:grid-cols-4 gap-8">
               <!-- Column 1: Logo & Tagline -->
               <div class="col-span-2 md:col-span-1">
                   <a href="/" class="text-2xl font-extrabold tracking-tight text-white mb-2 inline-block">
                       <span class="text-blue-500">The</span> Mandate Wire
                   </a>
                   <p class="text-sm text-gray-400 mt-2">The essential read for global professionals.</p>
               </div>

               <!-- Column 2: Navigation -->
               <div>
                   <h4 class="text-sm font-semibold uppercase text-blue-400 mb-4">Navigation</h4>
                   <ul class="space-y-3 text-base">
                       <li><a href="/posts" class="text-gray-300 hover:text-blue-400 transition duration-200">About Our Work</a></li>
                       <li><a href="/posts" class="text-gray-300 hover:text-blue-400 transition duration-200">Contact Editorial</a></li>
                       <li><a href="/posts" class="text-gray-300 hover:text-blue-400 transition duration-200">Article Archive</a></li>
                   </ul>
               </div>

               <!-- Column 3: Topics -->
               <div>
                   <h4 class="text-sm font-semibold uppercase text-blue-400 mb-4">Coverage</h4>
                   <ul class="space-y-3 text-base">
                       <li><a href="/posts" class="text-gray-300 hover:text-blue-400 transition duration-200">News</a></li>
                       <li><a href="/posts" class="text-gray-300 hover:text-blue-400 transition duration-200">Sport</a></li>
                       <li><a href="/posts" class="text-gray-300 hover:text-blue-400 transition duration-200">Business</a></li>
                       <li><a href="/posts" class="text-gray-300 hover:text-blue-400 transition duration-200">Innovation</a></li>
                       <li><a href="/posts" class="text-gray-300 hover:text-blue-400 transition duration-200">Culture</a></li>
                       <li><a href="/posts" class="text-gray-300 hover:text-blue-400 transition duration-200">Arts</a></li>
                       <li><a href="/posts" class="text-gray-300 hover:text-blue-400 transition duration-200">Travel</a></li>
                       <li><a href="/posts" class="text-gray-300 hover:text-blue-400 transition duration-200">Earth</a></li>
                   </ul>
               </div>

               <!-- Column 4: Compliance -->
               <div>
                   <h4 class="text-sm font-semibold uppercase text-blue-400 mb-4">Compliance</h4>
                   <ul class="space-y-3 text-base">
                       <li><a href="/posts" class="text-gray-300 hover:text-blue-400 transition duration-200">Subscription Terms</a></li>
                       <li><a href="/posts" class="text-gray-300 hover:text-blue-400 transition duration-200">Data Privacy</a></li>
                       <li><a href="/posts" class="text-gray-300 hover:text-blue-400 transition duration-200">Ethics Policy</a></li>
                   </ul>
               </div>
           </div>

           <div class="mt-12 pt-8 border-t border-gray-700 text-center">
               <p class="text-xs text-gray-500">&copy; <%= new Date().getFullYear() %> The Mandate Wire. All rights reserved. A service for market intelligence and policy foresight.</p>
           </div>
       </div>
   </footer>

   <!-- JavaScript for Subscription Mock -->
   <script>
       /**
        * Simple mock function for handling the subscription attempt (reused from previous version).
        */
       function handleSubscribe() {
           const emailInput = document.querySelector('#geopolitics input[type="email"]');
           const messageElement = document.getElementById('subscription-message');
           const email = emailInput.value.trim();

           if (!email) {
               messageElement.className = 'mt-2 text-xs text-red-700 h-4 font-semibold';
               messageElement.textContent = "Please enter a valid email address.";
               return;
           }

           // Simple email validation
           const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
           if (!emailRegex.test(email)) {
               messageElement.className = 'mt-2 text-xs text-red-700 h-4 font-semibold';
               messageElement.textContent = "The email format is invalid.";
               return;
           }

           // Mock successful subscription logic
           messageElement.className = 'mt-2 text-xs text-green-700 h-4 font-semibold';
           messageElement.textContent = `Success! Briefing request submitted.`;
           emailInput.value = ''; // Clear the input
       }
   </script>
</body>
</html>